{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport * as React from 'react';\nimport { initializeComponentRef, warnDeprecations, getId, KeyCodes, classNamesFunction, getNativeProps, inputProperties } from '../../Utilities';\nimport { IconButton } from '../../Button';\nimport { Icon } from '../../Icon';\nvar getClassNames = classNamesFunction();\nvar COMPONENT_NAME = 'SearchBox';\n\nvar SearchBoxBase =\n/** @class */\nfunction (_super) {\n  __extends(SearchBoxBase, _super);\n\n  function SearchBoxBase(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this._rootElement = React.createRef();\n    _this._inputElement = React.createRef();\n\n    _this._onClickFocus = function () {\n      var inputElement = _this._inputElement.current;\n\n      if (inputElement) {\n        _this.focus();\n\n        inputElement.selectionStart = inputElement.selectionEnd = 0;\n      }\n    };\n\n    _this._onFocusCapture = function (ev) {\n      _this.setState({\n        hasFocus: true\n      });\n\n      if (_this.props.onFocus) {\n        _this.props.onFocus(ev);\n      }\n    };\n\n    _this._onClearClick = function (ev) {\n      var clearButtonProps = _this.props.clearButtonProps;\n\n      if (clearButtonProps && clearButtonProps.onClick) {\n        clearButtonProps.onClick(ev);\n      }\n\n      if (!ev.defaultPrevented) {\n        _this._onClear(ev);\n      }\n    };\n\n    _this._onKeyDown = function (ev) {\n      switch (ev.which) {\n        case KeyCodes.escape:\n          _this.props.onEscape && _this.props.onEscape(ev); // Only call onClear if the search box has a value to clear. Otherwise, allow the Esc key\n          // to propagate from the empty search box to a parent element such as a dialog, etc.\n\n          if (_this.state.value && !ev.defaultPrevented) {\n            _this._onClear(ev);\n          }\n\n          break;\n\n        case KeyCodes.enter:\n          if (_this.props.onSearch) {\n            _this.props.onSearch(_this.state.value);\n\n            ev.preventDefault();\n            ev.stopPropagation();\n          }\n\n          break;\n\n        default:\n          _this.props.onKeyDown && _this.props.onKeyDown(ev);\n\n          if (ev.defaultPrevented) {\n            ev.stopPropagation();\n          }\n\n          break;\n      }\n    };\n\n    _this._onBlur = function (ev) {\n      _this.setState({\n        hasFocus: false\n      });\n\n      if (_this.props.onBlur) {\n        _this.props.onBlur(ev);\n      }\n    };\n\n    _this._onInputChange = function (ev) {\n      var value = ev.target.value;\n\n      if (value === _this._latestValue) {\n        return;\n      }\n\n      _this._latestValue = value;\n\n      _this.setState({\n        value: value\n      });\n\n      _this._callOnChange(ev, value);\n    };\n\n    initializeComponentRef(_this);\n    warnDeprecations(COMPONENT_NAME, props, {\n      labelText: 'placeholder',\n      defaultValue: 'value'\n    });\n    _this._latestValue = props.value || '';\n    _this._fallbackId = getId(COMPONENT_NAME);\n    _this.state = {\n      value: _this._latestValue,\n      hasFocus: false\n    };\n    return _this;\n  }\n\n  SearchBoxBase.prototype.UNSAFE_componentWillReceiveProps = function (newProps) {\n    if (newProps.value !== undefined) {\n      this._latestValue = newProps.value; // If the user passes in null, substitute an empty string\n      // (passing null is not allowed per typings, but users might do it anyway)\n\n      this.setState({\n        value: newProps.value || ''\n      });\n    }\n  };\n\n  SearchBoxBase.prototype.render = function () {\n    var _a = this.props,\n        ariaLabel = _a.ariaLabel,\n        placeholder = _a.placeholder,\n        className = _a.className,\n        disabled = _a.disabled,\n        underlined = _a.underlined,\n        styles = _a.styles,\n        // eslint-disable-next-line deprecation/deprecation\n    labelText = _a.labelText,\n        theme = _a.theme,\n        clearButtonProps = _a.clearButtonProps,\n        disableAnimation = _a.disableAnimation,\n        iconProps = _a.iconProps,\n        role = _a.role,\n        _b = _a.id,\n        id = _b === void 0 ? this._fallbackId : _b;\n    var _c = this.state,\n        value = _c.value,\n        hasFocus = _c.hasFocus;\n    var placeholderValue = placeholder !== undefined ? placeholder : labelText;\n    var classNames = getClassNames(styles, {\n      theme: theme,\n      className: className,\n      underlined: underlined,\n      hasFocus: hasFocus,\n      disabled: disabled,\n      hasInput: value.length > 0,\n      disableAnimation: disableAnimation\n    });\n    var nativeProps = getNativeProps(this.props, inputProperties, ['className', 'placeholder', 'onFocus', 'onBlur', 'value', 'role']);\n    return React.createElement(\"div\", {\n      role: role,\n      ref: this._rootElement,\n      className: classNames.root,\n      onFocusCapture: this._onFocusCapture\n    }, React.createElement(\"div\", {\n      className: classNames.iconContainer,\n      onClick: this._onClickFocus,\n      \"aria-hidden\": true\n    }, React.createElement(Icon, __assign({\n      iconName: \"Search\"\n    }, iconProps, {\n      className: classNames.icon\n    }))), React.createElement(\"input\", __assign({}, nativeProps, {\n      id: id,\n      className: classNames.field,\n      placeholder: placeholderValue,\n      onChange: this._onInputChange,\n      onInput: this._onInputChange,\n      onBlur: this._onBlur,\n      onKeyDown: this._onKeyDown,\n      value: value,\n      disabled: disabled,\n      role: \"searchbox\",\n      \"aria-label\": ariaLabel,\n      ref: this._inputElement\n    })), value.length > 0 && React.createElement(\"div\", {\n      className: classNames.clearButton\n    }, React.createElement(IconButton, __assign({\n      onBlur: this._onBlur,\n      styles: {\n        root: {\n          height: 'auto'\n        },\n        icon: {\n          fontSize: '12px'\n        }\n      },\n      iconProps: {\n        iconName: 'Clear'\n      }\n    }, clearButtonProps, {\n      onClick: this._onClearClick\n    }))));\n  };\n  /**\n   * Sets focus to the search box input field\n   */\n\n\n  SearchBoxBase.prototype.focus = function () {\n    if (this._inputElement.current) {\n      this._inputElement.current.focus();\n    }\n  };\n  /**\n   * Returns whether or not the SearchBox has focus\n   */\n\n\n  SearchBoxBase.prototype.hasFocus = function () {\n    return !!this.state.hasFocus;\n  };\n\n  SearchBoxBase.prototype._onClear = function (ev) {\n    this.props.onClear && this.props.onClear(ev);\n\n    if (!ev.defaultPrevented) {\n      this._latestValue = '';\n      this.setState({\n        value: ''\n      });\n\n      this._callOnChange(undefined, '');\n\n      ev.stopPropagation();\n      ev.preventDefault();\n      this.focus();\n    }\n  };\n\n  SearchBoxBase.prototype._callOnChange = function (ev, newValue) {\n    // eslint-disable-next-line deprecation/deprecation\n    var _a = this.props,\n        onChange = _a.onChange,\n        onChanged = _a.onChanged; // Call @deprecated method.\n\n    if (onChanged) {\n      onChanged(newValue);\n    }\n\n    if (onChange) {\n      onChange(ev, newValue);\n    }\n  };\n\n  SearchBoxBase.defaultProps = {\n    disableAnimation: false,\n    clearButtonProps: {\n      ariaLabel: 'Clear text'\n    }\n  };\n  return SearchBoxBase;\n}(React.Component);\n\nexport { SearchBoxBase };","map":null,"metadata":{},"sourceType":"module"}